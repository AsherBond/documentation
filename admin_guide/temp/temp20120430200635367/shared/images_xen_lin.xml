<?xml version="1.0" encoding="utf-8"?><?workdir /Users/scottb/Documents/git/documentation/admin_guide/temp/temp20120430200635367/shared?><?path2project ../?><task xmlns:ditaarch="http://dita.oasis-open.org/architecture/2005/" id="images_xen_lin" ditaarch:DITAArchVersion="1.2" domains="(topic task)                            (topic hi-d)                             (topic ut-d)                             (topic indexing-d)                            (topic hazard-d)                            (topic abbrev-d)                            (topic pr-d)                             (topic sw-d)                            (topic ui-d)                            (topic task strictTaskbody-c)    " class="- topic/topic task/task " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="task:1">
	<title class="- topic/title " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="title:1">Create Linux Image (Xen)</title>
	<shortdesc class="- topic/shortdesc " xtrc="shortdesc:1" xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita"/>
	<prolog class="- topic/prolog "><copyright class="- topic/copyright " xtrc="copyright:1" xtrf="/Users/scottb/Documents/git/documentation/ag.ditamap">
			<copyryear class="- topic/copyryear " xtrc="copyryear:1" xtrf="/Users/scottb/Documents/git/documentation/ag.ditamap" year="2012"/>
			<copyrholder class="- topic/copyrholder " xtrc="copyrholder:1" xtrf="/Users/scottb/Documents/git/documentation/ag.ditamap">Eucalyptus Systems</copyrholder>
		</copyright><metadata class="- topic/metadata "><prodinfo class="- topic/prodinfo " xtrc="prodinfo:1" xtrf="/Users/scottb/Documents/git/documentation/ag.ditamap">
			<prodname class="- topic/prodname " xtrc="prodname:1" xtrf="/Users/scottb/Documents/git/documentation/ag.ditamap">Eucalyptus</prodname>
			<vrmlist class="- topic/vrmlist " xtrc="vrmlist:1" xtrf="/Users/scottb/Documents/git/documentation/ag.ditamap">
				<vrm class="- topic/vrm " version="3.0" xtrc="vrm:1" xtrf="/Users/scottb/Documents/git/documentation/ag.ditamap"/>
			</vrmlist>
		</prodinfo></metadata></prolog><taskbody class="- topic/body task/taskbody " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="taskbody:1">
		<context class="- topic/section task/context " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="context:1">
			<note type="important" class="- topic/note " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="note:1">Before you begin, make sure that Xen installed and properly functioning for the account you are going to use.</note>
			<p class="- topic/p " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="p:1">To create a root filesystem to be used with Eucalyptus using Xen and an ISO image of the guest
				OS you want to install:</p>
			
		</context>
		<steps class="- topic/ol task/steps " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="steps:1">
			<step class="- topic/li task/step " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="step:1">
				<cmd class="- topic/ph task/cmd " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="cmd:1">Download the ISO image of the distro (guest OS) you want to install.</cmd>
			</step>
			<step class="- topic/li task/step " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="step:2">
				<cmd class="- topic/ph task/cmd " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="cmd:2">Create a virtual disk with the desired size. For example, to create a 4 GiB disk:</cmd>
				<info class="- topic/itemgroup task/info " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="info:1">
					<codeblock xml:space="preserve" class="+ topic/pre pr-d/codeblock " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="codeblock:1">dd if=/dev/zero of=&lt;image_name&gt; bs=1M count=4096</codeblock>
				</info>
			</step>
			<step class="- topic/li task/step " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="step:3">
				<cmd class="- topic/ph task/cmd " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="cmd:3">Create a Xen configuration file (for example, <filepath class="+ topic/ph sw-d/filepath " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="filepath:1">xen.cfg</filepath>) to boot off the
					ISO image. The file should look like the following:</cmd>
				<info class="- topic/itemgroup task/info " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="info:2">
					<codeblock xml:space="preserve" class="+ topic/pre pr-d/codeblock " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="codeblock:2">name = "bootFromISO"
kernel = "/usr/lib/xen/boot/hvmloader"
memory = 1024
builder = "hvm"
device_model = "/usr/lib64/xen/bin/qemu-dm"
boot = "d"
disk = ['file:PATH_TO_ISO,hdc:cdrom,r',
'file:PATH_TO/&lt;image_name&gt;,sda,w']
vif = ['mac=00:01:01:00:00:03, bridge=xenbr0']
dhcp="on"
vnc = 1
vncdisplay = 7
pae = 1</codeblock>
					<note type="important" class="- topic/note " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="note:2">You must modify <codeph class="+ topic/ph pr-d/codeph " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="codeph:1">device_model</codeph> and <codeph class="+ topic/ph pr-d/codeph " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="codeph:2">kernel</codeph> since they depend on where the
						distribution puts such files. Look into the Xen package file list. Also be sure that all the options are correct for your needs.</note>
				</info>
			</step>
			<step class="- topic/li task/step " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="step:4">
				<cmd class="- topic/ph task/cmd " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="cmd:4">Start the domU.</cmd>
				<info class="- topic/itemgroup task/info " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="info:3">
					<codeblock xml:space="preserve" class="+ topic/pre pr-d/codeblock " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="codeblock:3">xen create xen.cfg</codeblock>
				</info>
			</step>
			<step class="- topic/li task/step " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="step:5">
				<cmd class="- topic/ph task/cmd " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="cmd:5">Connect with a VNC viewer. For example:</cmd>
				<info class="- topic/itemgroup task/info " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="info:4">
					<codeblock xml:space="preserve" class="+ topic/pre pr-d/codeblock " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="codeblock:4">xvncviewer localhost:7</codeblock>
				</info>
			</step>
			<step class="- topic/li task/step " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="step:6">
				<cmd class="- topic/ph task/cmd " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="cmd:6">Install the distro as you would normally would. Do not use <codeph class="+ topic/ph pr-d/codeph " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="codeph:3">lvm</codeph> or <codeph class="+ topic/ph pr-d/codeph " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="codeph:4">md</codeph> and install everything in one partition. Remember the partition in which the distro is installed.</cmd>
				<info class="- topic/itemgroup task/info " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="info:5"><note type="important" class="- topic/note " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="note:3">Most distributions will remember the network interfaces by the MAC
					address, so interfaces will always be the same (that is, <codeph class="+ topic/ph pr-d/codeph " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="codeph:5">eth0</codeph> and
					<codeph class="+ topic/ph pr-d/codeph " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="codeph:6">eth1</codeph> will not be inverted accidentally). In Eucalyptus you have to get the
					distribution to forget the NIC, so that every instance will see the interface as the first
					interface. To do so you may want to refer to the specific distribution. For example Debian and
					Ubuntu use <codeph class="+ topic/ph pr-d/codeph " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="codeph:7">udev</codeph> so check <filepath class="+ topic/ph sw-d/filepath " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="filepath:2">/etc/udev/rules.d/*net*</filepath>. CentOS
					might have something in <filepath class="+ topic/ph sw-d/filepath " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="filepath:3">/etc/network-scripts/ifcfg-eth0</filepath>. Failure to do so
					may leave your instance without network.</note></info>
			</step>
			<step class="- topic/li task/step " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="step:7">
				<cmd class="- topic/ph task/cmd " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="cmd:7">Stop the domU.</cmd>
			</step>
			<step class="- topic/li task/step " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="step:8">
				<cmd class="- topic/ph task/cmd " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="cmd:8">Find out the starting block and the block size of the root file system.</cmd>
				<info class="- topic/itemgroup task/info " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="info:6">
					<codeblock xml:space="preserve" class="+ topic/pre pr-d/codeblock " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="codeblock:5">parted &lt;image_name&gt;</codeblock>
				</info>
			</step>
			<step class="- topic/li task/step " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="step:9">
				<cmd class="- topic/ph task/cmd " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="cmd:9">Change the units to blocks.</cmd>
				<info class="- topic/itemgroup task/info " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="info:7">
					<codeblock xml:space="preserve" class="+ topic/pre pr-d/codeblock " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="codeblock:6">(parted) u
Unit? [compact]? b</codeblock>
				</info>
			</step>
			<step class="- topic/li task/step " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="step:10">
				<cmd class="- topic/ph task/cmd " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="cmd:10">Print the current partition table using <codeph class="+ topic/ph pr-d/codeph " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="codeph:8">p</codeph>.</cmd>
				<stepresult class="- topic/itemgroup task/stepresult " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="stepresult:1">Note the start for the partition you are interested in and the size. For this
					example we'll say that the start is <codeph class="+ topic/ph pr-d/codeph " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="codeph:9">32256</codeph> and the size is <codeph class="+ topic/ph pr-d/codeph " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="codeph:10">1024000</codeph>.</stepresult>
			</step>
			<step class="- topic/li task/step " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="step:11">
				<cmd class="- topic/ph task/cmd " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="cmd:11">Extract the file system.</cmd>
				<info class="- topic/itemgroup task/info " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="info:8">
					<codeblock xml:space="preserve" class="+ topic/pre pr-d/codeblock " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="codeblock:7">dd if=&lt;image_name&gt; of=rootfs.img bs=1 skip=32256 count=1024000</codeblock>
					
				</info>
			</step>
		</steps>
		<result class="- topic/section task/result " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="result:1">You now have a root filesystem. Make sure that it is compatible with the kernel/initrd you are using in your
			cloud environment. In particular you may want to be sure you have the
			modules of the kernel you are going to use. Then you are ready to <xref href="add_existing.xml" class="- topic/xref " xtrf="/Users/scottb/Documents/git/documentation/shared/images_xen_lin.dita" xtrc="xref:1" type="task"><?ditaot usertext?>add the image<?ditaot genshortdesc?><desc class="- topic/desc "/></xref> to
			Eucalyptus.</result>
	</taskbody>
	
<related-links class="- topic/related-links "><linkpool class="- topic/linkpool " xtrc="topicref:106" xtrf="/Users/scottb/Documents/git/documentation/ag.ditamap"><link class="- topic/link " mapclass="- map/topicref " type="concept" xtrc="topicref:105" xtrf="/Users/scottb/Documents/git/documentation/ag.ditamap" href="../shared/creating_images.xml" role="parent"><?ditaot usertext?><linktext class="- topic/linktext "><?ditaot gentext?>Create an Image</linktext><?ditaot genshortdesc?><desc class="- topic/desc "/></link></linkpool></related-links>
</task>